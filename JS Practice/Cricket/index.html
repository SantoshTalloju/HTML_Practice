<!DOCTYPE html>
<html lang="en">
<head>
    <title>Cricket Game</title>
    <link rel="stylesheet" href="index.css">
</head>
<!-- Rules: 
1. Bat defeats ball
2. Ball defeats stumps
3. Stumps defeats bat -->
<body>
    <h1>Bat Ball Stump Game</h1>
    <button class="choice-button" onclick="
    //generate random number between 0 and 3
    let computerChoice = generateComputerChoice();
    let resultMessage = getResult('Bat', computerChoice);
    showResult('Bat', computerChoice, resultMessage);
    ">
        <img src="images/bat.png" class="choice-image" alt="Bat Image">
    </button>

    <button class="choice-button" onclick="
    computerChoice = generateComputerChoice();
    resultMessage = getResult('Ball', computerChoice);
    showResult('Ball', computerChoice, resultMessage);
     ">
        <img src="images/ball.png" class="choice-image" alt="Ball Image"> 
    </button>

    <button class="choice-button" onclick="
    computerChoice = generateComputerChoice();
    resultMessage = getResult('Stump', computerChoice);
    showResult('Stump', computerChoice, resultMessage);
    ">
        <img src="images/stump.png" class="choice-image" alt="Stump Image"> 
</button>

    <h3 id="user-move"></h3>
    <h3 id="computer-move"></h3>
    <h3 id="result"></h3>
    <h3 id="score"></h3>

    <button onclick="
    localStorage.clear();
    resetScore();">Reset</button>
</body>

<script>
    let scoreStr = localStorage.getItem('Score');
    let score;
    resetScore(scoreStr);
    
    function resetScore(scoreStr) {
        score = scoreStr ? JSON.parse(scoreStr) : {
            win: 0,
            loss: 0,
            tie: 0,
            };
        score.displayScore = function() {
                return `Number of Matches Won: ${score.win}, Lost: ${score.loss}, Tie: ${score.tie}`;
        }
        showResult();
    }

    // let score = JSON.parse(scoreStr) || {
    //     win: 0,
    //     loss: 0,
    //     tie: 0,
    //     };

    // if (scoreStr !== undefined) {
    //     score = JSON.parse(scoreStr);
    // } else {
    //     score = {
    //     win: 0,
    //     loss: 0,
    //     tie: 0,
    //     }
    // }

    function generateComputerChoice() {
        let randomNumber = Math.random() * 3;
        if(randomNumber > 0 && randomNumber <= 1){
            return 'Bat';
        } else if(randomNumber > 1 && randomNumber <= 2){
            return 'Ball';
        } else {
            return 'Stump';
        }
    }

    function getResult(userMove, computerMove) {
            if (userMove === 'Bat'){
                if (computerMove === 'Ball'){
                    score.win++;
                    return 'User won!';
                } else if (computerMove === 'Bat'){
                    score.tie++;
                    return `It's a tie`;
                } else if (computerMove === 'Stump'){
                    score.loss++;
                    return `Computer won!`;
                }
            } else if (userMove === 'Ball'){
                if (computerChoice === 'Ball'){
                    score.tie++;
                    return `It's a tie`;
                } else if (computerChoice === 'Bat'){
                    score.loss++;
                    return `Computer won!`;
                } else if (computerChoice === 'Stump'){
                    score.win++;
                    return `User won!`;
                }
            } else {
                if (computerChoice === 'Ball'){
                    score.loss++;
                    return `Computer won!`;
                } else if (computerChoice === 'Bat'){
                    score.win++;
                    return `User won!`;
                } else if (computerChoice === 'Stump'){
                    score.tie++;
                    return `It's a tie`;
                }
            }
    }

    function showResult(userMove, computerMove, resultMessage) {
        localStorage.setItem('Score', JSON.stringify(score));

        document.querySelector('#user-move').innerText = `You chose: ${userMove ? userMove : ''}`;
        document.querySelector('#computer-move').innerText = `Computer chose: ${computerMove ? computerMove : ''}`;
        document.querySelector('#result').innerText = resultMessage || '';
        document.querySelector('#score').innerText = score.displayScore();

        // alert(`You have chosen ${userMove}. Computer has chosen ${computerMove}. 
        
        // ${resultMessage}
        
        // ${score.displayScore()}
        // `);
    }
</script>
</html>